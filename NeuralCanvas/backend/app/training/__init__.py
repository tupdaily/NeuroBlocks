# Training loop and dataset utilities
